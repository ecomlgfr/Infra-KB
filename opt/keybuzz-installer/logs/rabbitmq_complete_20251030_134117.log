
Installation RabbitMQ Quorum Cluster HA (Quorum par dÃ©faut)
Timestamp: 2025-10-30 13:41:17

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 0: VÃ©rifications prÃ©alables                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Serveurs Queue trouvÃ©s: 3
  Serveurs HAProxy trouvÃ©s: 2
  queue-01: 10.0.0.126
  queue-02: 10.0.0.127
  queue-03: 10.0.0.128

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 1: Gestion sÃ©curisÃ©e des credentials                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Chargement des credentials existants...
  Cookie Erlang: 933db44067007b1b...

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 2: PrÃ©paration des serveurs RabbitMQ                     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  PrÃ©paration de queue-01 (10.0.0.126)...
Rule added
Rule added (v6)
Rule added
Rule added (v6)
Rule added
Rule added (v6)
Rule added
Rule added (v6)
rabbitmq
rabbitmq
    âœ“ Structure crÃ©Ã©e
  PrÃ©paration de queue-02 (10.0.0.127)...
Rule added
Rule added (v6)
Rule added
Rule added (v6)
Rule added
Rule added (v6)
Rule added
Rule added (v6)
rabbitmq
rabbitmq
    âœ“ Structure crÃ©Ã©e
  PrÃ©paration de queue-03 (10.0.0.128)...
Rule added
Rule added (v6)
Rule added
Rule added (v6)
Rule added
Rule added (v6)
Rule added
Rule added (v6)
rabbitmq
rabbitmq
    âœ“ Structure crÃ©Ã©e

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 3: DÃ©ploiement RabbitMQ (Quorum par dÃ©faut - PATCHÃ‰)     â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  DÃ©ploiement de queue-01...
bash: line 41: docker-compose: command not found
    âœ“ queue-01 dÃ©marrÃ© avec quorum par dÃ©faut
  DÃ©ploiement de queue-02...
bash: line 42: docker-compose: command not found
    âœ“ queue-02 dÃ©marrÃ© avec quorum par dÃ©faut
  DÃ©ploiement de queue-03...
bash: line 42: docker-compose: command not found
    âœ“ queue-03 dÃ©marrÃ© avec quorum par dÃ©faut

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 4: Formation du cluster                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Ajout de queue-02 au cluster...
    âœ— Ã‰chec de jonction
  Ajout de queue-03 au cluster...
    âœ— Ã‰chec de jonction

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 5: VÃ©rification (quorum par dÃ©faut activÃ©)               â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  VÃ©rification de default_queue_type sur queue-01:
    âœ— Configuration non trouvÃ©e

  Ã‰tat du cluster:

  Test de connectivitÃ©:
    queue-01: [0;31mKO[0m
    queue-02: [0;31mKO[0m
    queue-03: [0;31mKO[0m

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 6: Load Balancer HAProxy (UI interne seulement)          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Configuration de haproxy-01 (10.0.0.11)...
haproxy-rabbitmq
haproxy-rabbitmq
5e6fc9d2bc5795b2444485048621858fb2adb0c104f706e40c4d1e7fd8564c1f
    âœ“ HAProxy configurÃ© sur IP 159.69.159.32 (UI interne seulement)
  Configuration de haproxy-02 (10.0.0.12)...
haproxy-rabbitmq
haproxy-rabbitmq
c50ebbc9c44ae7ad2297816f1f39089b197ece57c6cf51636d63b7bc1da78324
    âœ“ HAProxy configurÃ© sur IP 91.98.164.223 (UI interne seulement)

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 7: Tests finaux                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Test HAProxy locaux:
    haproxy-01 (AMQP 5672): [0;31mKO[0m
    haproxy-01 (UI 15672): [0;31mKO[0m
    haproxy-02 (AMQP 5672): [0;31mKO[0m
    haproxy-02 (UI 15672): [0;31mKO[0m

  Test via Load Balancer Hetzner (10.0.0.10):
    AMQP (5672): [0;32mOK[0m
    Management UI (15672): [0;32mOK[0m (accÃ¨s via SSH tunnel recommandÃ©)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0;32mOK[0m RABBITMQ HA INSTALLATION COMPLÃˆTE ET OPÃ‰RATIONNELLE

Endpoints:
  â€¢ AMQP: 10.0.0.10:5672
  â€¢ Management: http://10.0.0.10:15672 (SSH tunnel recommandÃ©)
  â€¢ User: admin
  â€¢ Quorum par dÃ©faut: ACTIVÃ‰ âœ“

Pour tester:
  ssh -L 15672:10.0.0.10:15672 root@<install-01>
  Puis: http://localhost:15672

RÃ©sumÃ© complet: /opt/keybuzz-installer/credentials/rabbitmq-summary.txt
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Test de connectivitÃ©:
    queue-01: [0;31mKO[0m
    queue-02: [0;31mKO[0m
    queue-03: [0;31mKO[0m

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 6: Load Balancer HAProxy (UI interne seulement)          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Configuration de haproxy-01 (10.0.0.11)...
haproxy-rabbitmq
haproxy-rabbitmq
5e6fc9d2bc5795b2444485048621858fb2adb0c104f706e40c4d1e7fd8564c1f
    âœ“ HAProxy configurÃ© sur IP 159.69.159.32 (UI interne seulement)
  Configuration de haproxy-02 (10.0.0.12)...
haproxy-rabbitmq
haproxy-rabbitmq
c50ebbc9c44ae7ad2297816f1f39089b197ece57c6cf51636d63b7bc1da78324
    âœ“ HAProxy configurÃ© sur IP 91.98.164.223 (UI interne seulement)

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 7: Tests finaux                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

  Test HAProxy locaux:
    haproxy-01 (AMQP 5672): [0;31mKO[0m
    haproxy-01 (UI 15672): [0;31mKO[0m
    haproxy-02 (AMQP 5672): [0;31mKO[0m
    haproxy-02 (UI 15672): [0;31mKO[0m

  Test via Load Balancer Hetzner (10.0.0.10):
    AMQP (5672): [0;32mOK[0m
    Management UI (15672): [0;32mOK[0m (accÃ¨s via SSH tunnel recommandÃ©)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0;32mOK[0m RABBITMQ HA INSTALLATION COMPLÃˆTE ET OPÃ‰RATIONNELLE

Endpoints:
  â€¢ AMQP: 10.0.0.10:5672
  â€¢ Management: http://10.0.0.10:15672 (SSH tunnel recommandÃ©)
  â€¢ User: admin
  â€¢ Quorum par dÃ©faut: ACTIVÃ‰ âœ“

Pour tester:
  ssh -L 15672:10.0.0.10:15672 root@<install-01>
  Puis: http://localhost:15672

RÃ©sumÃ© complet: /opt/keybuzz-installer/credentials/rabbitmq-summary.txt
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
