
â•â•â• 1. Gestion des credentials â•â•â•

  Credentials existants conservÃ©s

â•â•â• 2. Configuration des nÅ“uds â•â•â•

â†’ Configuration db-master-01 (10.0.0.120)
  [0;32mOK[0m Configuration terminÃ©e
â†’ Configuration db-slave-01 (10.0.0.121)
  [0;32mOK[0m Configuration terminÃ©e
â†’ Configuration db-slave-02 (10.0.0.122)
  [0;32mOK[0m Configuration terminÃ©e

â•â•â• 3. DÃ©marrage parallÃ¨le du cluster RAFT â•â•â•

[0;33mâš [0m Avec RAFT, tous les nÅ“uds doivent dÃ©marrer ensemble pour le quorum

â†’ Lancement db-master-01 (10.0.0.120)...
â†’ Lancement db-slave-01 (10.0.0.121)...
â†’ Lancement db-slave-02 (10.0.0.122)...

  Attente Ã©tablissement du quorum RAFT (60s)...

â•â•â• 4. VÃ©rification du quorum et Ã©lection du leader â•â•â•

  Tentative 1/10...
  [0;32mOK[0m Leader trouvÃ©: db-slave-02 (10.0.0.122)

â•â•â• 5. CrÃ©ation des bases et utilisateurs â•â•â•

  [0;32mOK[0m

â•â•â• 6. VÃ©rification finale du cluster â•â•â•

  db-master-01 (10.0.0.120): [0;32mOK[0m Replica
  db-slave-01 (10.0.0.121): [0;32mOK[0m Replica
  db-slave-02 (10.0.0.122): [0;32mOK[0m Leader

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0;32mOK[0m CLUSTER PATRONI RAFT OPÃ‰RATIONNEL (3/3 nÅ“uds)
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Leader: db-slave-02 (10.0.0.122)
Credentials: /opt/keybuzz-installer/credentials/postgres.env

Test connexion:
  export PGPASSWORD='b2eUq9eBCxTMsatoQMNJ'
  psql -h 10.0.0.122 -U postgres -d keybuzz -c 'SELECT version()'

API Patroni (vÃ©rifier le cluster):
  curl -s http://10.0.0.122:8008/cluster | jq

Prochaine Ã©tape: ./05_haproxy_db_CORRECTED.sh
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
