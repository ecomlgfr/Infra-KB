â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘   KeyBuzz DB Suite Doctor â€“ PgBouncer/HAProxy/Patroni (TCP)    
â•‘   no-interactive â€¢ idempotent â€¢ private IPs â€¢ SCRAM+auth_query 
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[1;33mINFO[0m Propos: P1=10.0.0.11  P2=10.0.0.12  |  DBs: 10.0.0.120/10.0.0.121/10.0.0.122  |  VIP=10.0.0.10  PGB=6432  RW=5432 RO=5433  HC=8008
[0;32mOK[0m Leader: 10.0.0.121
â†’ Patch pg_hba @10.0.0.120
  [0;32mOK[0m reload
â†’ Patch pg_hba @10.0.0.121
  [0;32mOK[0m reload
â†’ Patch pg_hba @10.0.0.122
  [0;32mOK[0m reload
â†’ Patch HAProxy @10.0.0.11
  [0;31mKO[0m config invalide
/opt/keybuzz-installer/scripts/08_PostgreSQL_16_HA_Patroni/kb_db_doctor_v2.sh: line 154: [: missing `]'
â†’ write pgbouncer files @10.0.0.11
  [0;31mKO[0m pgbouncer listen
â†’ write pgbouncer files @10.0.0.12
  [0;32mOK[0m pgbouncer listening
/opt/keybuzz-installer/scripts/08_PostgreSQL_16_HA_Patroni/kb_db_doctor_v2.sh: line 225: syntax error near unexpected token `('
/opt/keybuzz-installer/scripts/08_PostgreSQL_16_HA_Patroni/kb_db_doctor_v2.sh: line 225: `    ssh -o StrictHostKeyChecking=no "$LEADER" "[ -s $ROOT/credentials/pgbouncer/pgbouncer/pgbouncer_secret ] || { umsg=\$(head -c 24 /dev/urandom | base64); echo \"\$umsg\" > $ROOT/credentials/pgbouncer/pgbouncer/pgbouncer_secret; }"'
