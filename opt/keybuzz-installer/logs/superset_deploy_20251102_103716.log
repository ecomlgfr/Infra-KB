
DÃ©ploiement Superset - Architecture KeyBuzz (CORRIGÃ‰)
Timestamp: 2025-11-02 10:37:16

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 0: VÃ©rifications prÃ©alables                              â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â†’ Credentials PostgreSQL ... [0;32mOK[0m
â†’ Credentials Redis ... [0;32mOK[0m
â†’ Cluster K3s ... [0;32mOK[0m

VÃ©rification des services backend (via LB 10.0.0.10) :
  â†’ PostgreSQL (10.0.0.10:5432) ... [0;32mOK[0m
  â†’ Redis (10.0.0.10:6379) ... [0;32mOK[0m

Architecture validÃ©e :
  âœ“ PostgreSQL : 10.0.0.10:5432 (via LB Hetzner â†’ HAProxy â†’ Patroni)
  âœ“ Redis      : 10.0.0.10:6379 (via LB Hetzner â†’ HAProxy â†’ Sentinel)

Continuer le dÃ©ploiement Superset ? (yes/NO) : 
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 0.5: Nettoyage des ressources existantes                â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Suppression des ressources existantes (si prÃ©sentes)...
deployment.apps "superset" deleted from superset namespace
  (dÃ©jÃ  supprimÃ©)
  (dÃ©jÃ  supprimÃ©)
Attente de la suppression complÃ¨te (10s)...
[0;32mOK[0m Nettoyage terminÃ©

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 1: CrÃ©ation namespace et secrets                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

[0;32mOK[0m Namespace superset crÃ©Ã©

CrÃ©ation du secret Superset...
secret/superset-secrets configured
[0;32mOK[0m Secret superset-secrets crÃ©Ã©

CrÃ©ation du ConfigMap superset-config...
configmap/superset-config unchanged
[0;32mOK[0m ConfigMap superset-config crÃ©Ã©

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 2: DÃ©ploiement Superset (Init DB + Deployment)          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

job.batch/superset-init-db created
job.batch/superset-create-admin created
deployment.apps/superset created
service/superset unchanged
ingress.networking.k8s.io/superset unchanged
[0;32mOK[0m Ressources Superset crÃ©Ã©es

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ Ã‰TAPE 3: Attente init DB et dÃ©marrage pods                    â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Attente du job init-db (180s max)...
[0;33mWARN[0m Init DB prend plus de temps, vÃ©rification des logs...
Defaulted container "init-db" out of: init-db, install-psycopg2 (init)
Defaulting to user installation because normal site-packages is not writeable
WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.HTTPSConnection object at 0x79eb4f9d8e20>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /simple/psycopg2-binary/

Attente du job create-admin (120s max)...
[0;33mWARN[0m Create admin prend plus de temps, vÃ©rification des logs...
Defaulting to user installation because normal site-packages is not writeable
WARNING: Retrying (Retry(total=4, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7c6700514fd0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /simple/psycopg2-binary/
WARNING: Retrying (Retry(total=3, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7c6700515300>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /simple/psycopg2-binary/
WARNING: Retrying (Retry(total=2, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7c67005154b0>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /simple/psycopg2-binary/
WARNING: Retrying (Retry(total=1, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7c6700515660>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /simple/psycopg2-binary/
WARNING: Retrying (Retry(total=0, connect=None, read=None, redirect=None, status=None)) after connection broken by 'NewConnectionError('<pip._vendor.urllib3.connection.HTTPSConnection object at 0x7c6700515810>: Failed to establish a new connection: [Errno -3] Temporary failure in name resolution')': /simple/psycopg2-binary/
ERROR: Could not find a version that satisfies the requirement psycopg2-binary (from versions: none)
ERROR: No matching distribution found for psycopg2-binary

Attente des pods Superset (120s max)...
pod/superset-create-admin-dzjm2 condition met
[0;33mWARN[0m Pods pas encore prÃªts

â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘ RÃ‰SUMÃ‰ FINAL                                                   â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Ã‰tat des jobs :
NAME                    COMPLETIONS   DURATION   AGE
superset-create-admin   0/1           7m         7m
superset-init-db        0/1           7m         7m

Ã‰tat des pods Superset :
NAME                          READY   STATUS    RESTARTS       AGE    IP           NODE            NOMINATED NODE   READINESS GATES
superset-create-admin-dzjm2   1/1     Running   2 (2m1s ago)   7m1s   10.42.7.18   k3s-worker-05   <none>           <none>
superset-db5c4c8c8-98p4p      0/1     Running   1 (2m1s ago)   7m1s   10.42.3.47   k3s-worker-01   <none>           <none>
superset-db5c4c8c8-z4vsz      0/1     Running   1 (2m ago)     7m1s   10.42.4.25   k3s-worker-02   <none>           <none>
superset-init-db-7925b        1/1     Running   1 (2m ago)     7m1s   10.42.4.24   k3s-worker-02   <none>           <none>

Ã‰tat du service :
NAME       TYPE        CLUSTER-IP     EXTERNAL-IP   PORT(S)    AGE
superset   ClusterIP   10.43.40.140   <none>        8088/TCP   32m

Ã‰tat de l'Ingress :
NAME       CLASS   HOSTS                 ADDRESS     PORTS   AGE
superset   nginx   superset.keybuzz.io   localhost   80      41h

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
[0;32mOK[0m SUPERSET DÃ‰PLOYÃ‰
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

URL d'accÃ¨s : http://superset.keybuzz.io

âš ï¸  IMPORTANT - Configuration DNS requise :
  superset.keybuzz.io  A  49.13.42.76      TTL 60
  superset.keybuzz.io  A  138.199.132.240  TTL 60

Credentials :
  Username : admin
  Password : Admin123!
  Email    : admin@keybuzz.io

Logs utiles :
  kubectl logs -n superset -l app=superset --tail=50
  kubectl logs -n superset job/superset-init-db
  kubectl logs -n superset job/superset-create-admin

Architecture :
  âœ“ PostgreSQL : 10.0.0.10:5432 (LB Hetzner â†’ HAProxy â†’ Patroni)
  âœ“ Redis      : 10.0.0.10:6379 (LB Hetzner â†’ HAProxy â†’ Sentinel)

Prochaine Ã©tape :
  ./14_test_all_apps.sh

